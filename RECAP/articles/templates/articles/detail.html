{% extends 'base.html' %}
{% load bootstrap4 %}
{% block body %}
<h1>상세페이지</h1>
<h4>{{ article.title }}</h4>
<p>{{ article.pk }}</p>
<p>{{ article.content }}</p>
<p>{{ article.user.first_name }}</p>
<p>{{ article.created_at|date:"Y년 M j일" }}</p>
<p>{{ article.updated_at|date:"SHORT_DATE_FORMAT" }}</p>
<!-- <p>{{ article.updated_at|date:"Y년 M j일" }}</p> -->
<a href="{% url 'articles:index' %}">홈으로</a>

<br>
{% if article.user == request.user %}
  <a href="{% url 'articles:update' article.pk %}">수정</a>
  <!-- a 태그는 기본적으로 get으로 보냄 -->
  <!-- <a href="{% url 'articles:delete' article.pk %}">삭제</a> -->
  <!-- POST로 보내기 위해선 form을 만들면 됨 -->
  <form action="{% url 'articles:delete' article.pk %}" method="POST">
    {% csrf_token %}
    <input type="submit" value="삭제">
  </form>
{% endif %}

{% if user.is_authenticated %}
<form action="{% url 'articles:create_comment' article.pk %}" method='POST'>
  {% csrf_token %}
  {% bootstrap_form comment_form %}
  <input type="submit">
</form>
{% endif %}
<hr>
<h2>해시태그목록</h2>
<p>
  {% for hashtag in article.hashtags.all %}
    <strong>{{ hashtag }}</strong>
  {% endfor %}
</p>

<hr>
<p>좋아요 : {{ article.like_users.count }}개</p>
<p>좋아하는 사람 :
  {% with likers=article.like_users.all %}
    {% for liker in likers %}
      {{ liker }}
    {% endfor %}
</p>  
  {% if user.is_authenticated %}
  {% if user in likers %}
    <a class='btn' href="{% url 'articles:like' article.pk %}">좋아요 취소</a>
  {% else %}
    <a class='btn' href="{% url 'articles:like' article.pk %}">좋아요</a>
  {% endif %}
  {% endif %}
{% endwith %}


<hr>
<h2>댓글목록</h2>
{% for comment in comments %}
  <p>{{ comment.user }} : {{ comment.content }}</p>
{% endfor %}

<!-- {{ comment_form }} : 그냥 form d은 중괄호 두개 -->
{% endblock %}